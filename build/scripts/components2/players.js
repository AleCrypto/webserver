define(["lib/react","lib/clib","lib/lodash"],function(e,t,n){var r=e.DOM;return e.createClass({displayName:"usersPlaying",propTypes:{engine:e.PropTypes.object.isRequired},render:function(){var e=this,i=[],s=[],o,u,a,f,l,c,h;n.forEach(e.props.engine.playerInfo,function(e,t,n){e.stopped_at?i.push({username:t,info:e}):s.push({username:t,info:e})});var p=n.sortBy(i,function(e){return e.info.stopped_at}).reverse(),d=n.sortBy(s,function(e){return e.info.bet}).reverse();if(e.props.engine.gameState==="IN_PROGRESS"||e.props.engine.gameState==="STARTING"){u=[];for(var v=0,m=d.length;v<m;v++)u.push(r.tr({className:"user-playing",key:"user"+v},r.td(null,d[v].username),r.td(null,"-"),r.td(null,t.formatSatoshis(d[v].info.bet,0)),r.td(null,"-")));o=[];for(var v=0,m=p.length;v<m;v++){var g=p[v],y=g.info.bet;o.push(r.tr({className:"user-cashed",key:"user"+v},r.td(null,g.username),r.td(null,g.info.stopped_at/100+"x"),r.td(null,t.formatSatoshis(y,0)),r.td(null,t.formatSatoshis(g.info.stopped_at/100*y-y))))}l=r.tbody({className:""},u,o),c="users-playing-container",h="users-playing"}else e.props.engine.gameState==="ENDED"&&(u=d.map(function(e,n){var i=e.info.bonus,s="-"+t.formatSatoshis(e.info.bet);return i&&(s=s+" (+"+t.formatSatoshis(i)+")"),r.tr({className:"user-lost",key:"user"+n},r.td(null,e.username),r.td(null,"-"),r.td(null,t.formatSatoshis(e.info.bet,0)),r.td(null,s))}),o=p.map(function(e,n){var i=e.info.bet,s=e.info.bonus,o=e.info.stopped_at,u=t.formatSatoshis(i*(o-100)/100);return s&&(u=u+" (+"+t.formatSatoshis(s)+")"),r.tr({className:"user-won",key:"user"+n},r.td(null,e.username),r.td(null,o/100,"x"),r.td(null,t.formatSatoshis(i,0)),r.td(null,u))}),l=r.tbody({className:""},u,o),c="users-cashed-container",h="users-summary");return r.div({className:c},r.table({className:h},r.thead(null,r.tr(null,r.th(null,"User"),r.th(null,"@"),r.th(null,"Bet"),r.th(null,"Profit"))),l))}})});